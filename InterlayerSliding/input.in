processors * 1 1
units metal
dimension 3
boundary p p p
atom_style f ull
read_data XX.data
pair_style hybrid/overlay rebo kolmogorov/crespi/full 16.0 1
pair_coeff * * rebo CH. rebo C C
pair_coeff * * kolmogorov/crespi/full CH_taper.KC C C

neighbor 2.0 bin
neigh_modify every 1000 delay 0 check yes

#### group #####
group c type 1 2
group down type 1
group up type 2

variable a equal bound (c,xmin)+10
variable b equal bound (c,xmax)-10
region left block INF $a INF INF INF 2 units box
region right block $b INF INF INF 2 INF units box
group left region left
group right region right

##### minimize #####
fix relax all box/ relax y 0.0 vmax 0.0001 dilate all n reset 100
min_style cg
min_modify dmax 0.2
minimize 0 1.0e−5 100000 100000000
write_data mini.data
##### compute and output ######
compute c1 down com
compute c2 up com
compute epol all pe/ atom
compute 1 all stress/atom NULL
compute rb all pair rebo
variable atomVol equal 8.382017396
variable AtmtoGPa equal 0.0001
variable scale equal v_AtmtoGPa/v_atomVol
variable s1 atom c_1[1]*v_scale
variable s2 atom c_1[2]*v_scale
variable s3 atom c_1[3]*v_scale
variable s4 atom c_1[4]*v_scale
variable s5 atom c_1[5]*v_scale
variable s6 atom c_1[6]*v_scale

variable faa equal f_1[1]
variable fab equal f_1[2]
variable fba equal f_2[1]
variable fbb equal f_2[2]

variable upxmin equal bound(up,xmin)
variable upxmax equal bound(up,xmax)
variable downxmin equal bound(down, xmin)
variable downxmax equal bound(down,xmax)

thermo 100
thermo_style custom step pe c_c1[3] c_c2[3] v_downxmin v_downxmax v_upxmin v_upxmax v_faa v_fba

##### constrain edge and shear #####
fix 1 left setforce 0.0 NULL 0.0
fix 2 right setforce 0.0 NULL 0.0

variable i loop 1000
label loopi
displace_atoms left move −0.1 0 0 units box
displace_atoms right move 0.1 0 0 units box 
fix relax all box/relax y 0.0 vmax 0.0001 dilate all nreset 100 #Poisson's effect
min_style cg
min_modify dmax 0.2
minimize 0 1.0e−5 100000 100000000
write_restart $i.restart
dump 1 all custom 1 $i.dump id mol x y z v_s1 v_s2 v_s3 v_s4 v_s5 v_s6 c_epol
dump_modify 2 element C C sort id
run 0
undump 1
next i
jump input.in loopi